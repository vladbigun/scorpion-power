(()=>{var e={184:(e,t)=>{var n;!function(){"use strict";var l={}.hasOwnProperty;function s(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(n){var a=typeof n;if("string"===a||"number"===a)e.push(n);else if(Array.isArray(n)){if(n.length){var o=s.apply(null,n);o&&e.push(o)}}else if("object"===a)if(n.toString===Object.prototype.toString)for(var r in n)l.call(n,r)&&n[r]&&e.push(r);else e.push(n.toString())}}return e.join(" ")}e.exports?(s.default=s,e.exports=s):void 0===(n=function(){return s}.apply(t,[]))||(e.exports=n)}()},991:e=>{e.exports=function(){return this.lodash}()},514:e=>{e.exports=function(){return this.wp.apiFetch}()},893:e=>{e.exports=function(){return this.wp.components}()},576:e=>{e.exports=function(){return this.wp.compose}()},15:e=>{e.exports=function(){return this.wp.data}()},197:e=>{e.exports=function(){return this.wp.editPost}()},353:e=>{e.exports=function(){return this.wp.editSite}()},293:e=>{e.exports=function(){return this.wp.element}()},638:e=>{e.exports=function(){return this.wp.htmlEntities}()},122:e=>{e.exports=function(){return this.wp.i18n}()},19:e=>{e.exports=function(){return this.wp.keycodes}()},571:e=>{e.exports=function(){return this.wp.plugins}()},776:e=>{e.exports=function(){return this.wp.primitives}()},470:e=>{e.exports=function(){return this.wp.url}()}},t={};function n(l){var s=t[l];if(void 0!==s)return s.exports;var a=t[l]={exports:{}};return e[l](a,a.exports,n),a.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var l in t)n.o(t,l)&&!n.o(e,l)&&Object.defineProperty(e,l,{enumerable:!0,get:t[l]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var l={};(()=>{"use strict";n.r(l);var e=n(293),t=n(571),s=n(15),a=n(991),o=n(197),r=n(353),i=n(122),c=n(514),p=n.n(c),u=n(470),d=n(893),g=n(576);class h extends e.Component{constructor(){super(...arguments),this.confirmButton=(0,e.createRef)()}componentDidMount(){this.confirmButton.current.focus()}render(){const{idPrefix:t,title:n,updateState:l,handleChange:s,children:a}=this.props;return(0,e.createElement)(d.Modal,{title:n,className:"confirmBox",onRequestClose:l,shouldCloseOnEsc:!1,shouldCloseOnClickOutside:!1,focusOnMount:!1},a,(0,e.createElement)(d.ButtonGroup,{className:"buttons"},(0,e.createElement)(d.Button,{id:`${t}_confirm`,ref:this.confirmButton,isPrimary:!0,onClick:e=>{s(e),l()}},(0,i.__)("OK","polylang-pro")),(0,e.createElement)(d.Button,{id:`${t}_cancel`,isSecondary:!0,onClick:()=>l()},(0,i.__)("Cancel","polylang-pro"))))}}const m=function(t,n,l){return(0,g.createHigherOrderComponent)((s=>{class o extends e.Component{constructor(){super(...arguments),this.state={isOpen:!1,changeValue:null},this.handleChange=this.handleChange.bind(this)}handleChange(e){let t=s.getChangeValue(e);const n=this.props.currentPost;(0,a.isNil)(n)||(t={templateId:t,currentPost:n}),!(0,a.isUndefined)(s.bypassConfirmation)&&s.bypassConfirmation(this.props.translationData)?l(t):this.setState({isOpen:!0,changeValue:t})}render(){var o;const r=null===(o=this.props.translationData)||void 0===o?void 0:o.is_default_lang,i=this.props,c=Object.assign({},{...i},{handleChange:this.handleChange});return(0,e.createElement)(e.Fragment,null,(0,e.createElement)(s,c),this.state.isOpen&&(0,e.createElement)(h,{title:s.labelConfirmationModal,idPrefix:t,handleChange:()=>l(this.state.changeValue),updateState:()=>this.setState({isOpen:!1,changeValue:null})},(0,e.createElement)(n,(0,a.isNil)(r)?{}:{isDefaultLang:r})))}}return o.bypassConfirmation=s.bypassConfirmation,o.getChangeValue=s.getChangeValue,o}),"withConfirmation")},f="pll/metabox",_="core/editor",y="core/edit-site",v="core",E={languages:[],selectedLanguage:{},translatedPosts:{},fromPost:null,currentTemplatePart:{}},w=["wp_template"];function b(e){const t={};return e.forEach((function(e,t,n){this[t]=(0,a.isBoolean)(e)?e.toString():e}),t),t}function P(){return!(!document.getElementById("site-editor")&&!document.getElementById("edit-site-editor"))}function S(e){return(0,s.select)(f).getLanguages().get(e)}function C(e){return e===function(){const e=(0,s.select)(f).getLanguages();return Array.from(e.values()).find((e=>e.is_default_lang))}().slug}function T(e,t,n){const l=x(t,n),o=(0,s.select)(f).getFromPost();let r=new Map(Object.entries([]));return(0,a.isUndefined)(e)||(r=new Map(Object.entries(e))),(0,a.isNil)(o)||(0,a.isNil)(o.id)||l.forEach(((e,t)=>{(0,a.isNil)(e.translated_post)||(0,a.isNil)(e.translated_post.id)||r.set(t,e.translated_post.id)})),r}function N(e){let t=new Map(Object.entries([]));return(0,a.isUndefined)(e)||(t=new Map(Object.entries(e))),t}function x(e,t){let n=new Map(Object.entries([]));return(0,a.isUndefined)(e)||(n=new Map(Object.entries(e))),n}function L(e){let t={};return e.forEach((e=>{e.is_default_lang&&(t=e.lang)})),t}var k=n(776);const A=!(0,a.isUndefined)(wp.primitives)?(0,e.createElement)(k.SVG,{width:"20",height:"20",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},(0,e.createElement)(k.Path,{d:"M6 15v-13h10v13h-10zM5 16h8v2h-10v-13h2v11z"})):"admin-page",U=!(0,a.isUndefined)(wp.primitives)?(0,e.createElement)(k.SVG,{width:"20",height:"20",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},(0,e.createElement)(k.Path,{d:"M13.89 3.39l2.71 2.72c0.46 0.46 0.42 1.24 0.030 1.64l-8.010 8.020-5.56 1.16 1.16-5.58s7.6-7.63 7.99-8.030c0.39-0.39 1.22-0.39 1.68 0.070zM11.16 6.18l-5.59 5.61 1.11 1.11 5.54-5.65zM8.19 14.41l5.58-5.6-1.070-1.080-5.59 5.6z"})):"edit",O=!(0,a.isUndefined)(wp.primitives)?(0,e.createElement)(k.SVG,{width:"20",height:"20",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},(0,e.createElement)(k.Path,{d:"M17 7v3h-5v5h-3v-5h-5v-3h5v-5h3v5h5z"})):"plus",D=!(0,a.isUndefined)(wp.primitives)?(0,e.createElement)(k.SVG,{width:"20",height:"20",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},(0,e.createElement)(k.Path,{d:"M5 7v3l-2 1.5v-6.5h11v-2l4 3.010-4 2.99v-2h-9zM15 13v-3l2-1.5v6.5h-11v2l-4-3.010 4-2.99v2h9z"})):"controls-repeat",M=!(0,a.isUndefined)(wp.primitives)?(0,e.createElement)(k.SVG,{width:"20",height:"20",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},(0,e.createElement)(k.Path,{d:"M11 7H9.49c-.63 0-1.25.3-1.59.7L7 5H4.13l-2.39 7h1.69l.74-2H7v4H2c-1.1 0-2-.9-2-2V5c0-1.1.9-2 2-2h7c1.1 0 2 .9 2 2v2zM6.51 9H4.49l1-2.93zM10 8h7c1.1 0 2 .9 2 2v7c0 1.1-.9 2-2 2h-7c-1.1 0-2-.9-2-2v-7c0-1.1.9-2 2-2zm7.25 5v-1.08h-3.17V9.75h-1.16v2.17H9.75V13h1.28c.11.85.56 1.85 1.28 2.62-.87.36-1.89.62-2.31.62-.01.02.22.97.2 1.46.84 0 2.21-.5 3.28-1.15 1.09.65 2.48 1.15 3.34 1.15-.02-.49.2-1.44.2-1.46-.43 0-1.49-.27-2.38-.63.7-.77 1.14-1.77 1.25-2.61h1.36zm-3.81 1.93c-.5-.46-.85-1.13-1.01-1.93h2.09c-.17.8-.51 1.47-1 1.93l-.04.03s-.03-.02-.04-.03z"})):"translation",R=!(0,a.isUndefined)(wp.primitives)?(0,e.createElement)(k.SVG,{width:"20",height:"20",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},(0,e.createElement)(k.Path,{d:"M12 4h3c.6 0 1 .4 1 1v1H3V5c0-.6.5-1 1-1h3c.2-1.1 1.3-2 2.5-2s2.3.9 2.5 2zM8 4h3c-.2-.6-.9-1-1.5-1S8.2 3.4 8 4zM4 7h11l-.9 10.1c0 .5-.5.9-1 .9H5.9c-.5 0-.9-.4-1-.9L4 7z"})):"trash",z=!(0,a.isUndefined)(wp.primitives)?(0,e.createElement)(k.SVG,{width:"20",height:"20",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},(0,e.createElement)(k.Path,{d:"m10 1 3 6 6 .75-4.12 4.62L16 19l-6-3-6 3 1.13-6.63L1 7.75 7 7z"})):"star-filled";const F=function(t){let{language:n}=t;return(0,a.isNil)(n)?(0,e.createElement)("span",{className:"pll-translation-icon"},M):(0,a.isEmpty)(n.flag_url)?(0,e.createElement)("abbr",null,n.slug,(0,e.createElement)("span",{className:"screen-reader-text"},n.name)):(0,e.createElement)("span",{className:"pll-select-flag"},(0,e.createElement)("img",{src:n.flag_url,alt:n.name,title:n.name,className:"flag"}))};function I(t){let{handleChange:n,children:l,selectedLanguage:s=null,defaultValue:a=""}=t;const o=null!=s&&s.slug?s.slug:a;return(0,e.createElement)("div",{id:"select-post-language"},(0,e.createElement)(F,{language:s}),l&&(0,e.createElement)("select",{value:o,onChange:e=>n(e),id:"pll_post_lang_choice",name:"pll_post_lang_choice",className:"post_lang_choice"},l))}function j(t){let{languages:n}=t;return Array.from(n.values()).map((t=>{let{slug:n,name:l,w3c:s}=t;return(0,e.createElement)("option",{value:n,lang:s,key:n},l)}))}class B extends e.Component{static bypassConfirmation(){const e=(0,s.select)(_);return!e.getEditedPostAttribute("title")&&!e.getEditedPostContent()&&!e.getEditedPostAttribute("excerpt")}static getChangeValue(e){return e.target.value}static handleLanguageChange(e){const t=(0,s.select)(_).getEditedPostAttribute("lang"),n=(0,s.select)(_).getCurrentPostId(),l=(0,s.select)(f).getLanguages().get(e),a=S(t),o=N((0,s.select)(_).getEditedPostAttribute("pll_sync_post")),r=(0,s.select)(_).getEditedPostAttribute("translations_table"),i=T((0,s.select)(_).getEditedPostAttribute("translations"),r,a.slug),c=x(r,a.slug);i.delete(a.slug),i.set(l.slug,n),o.delete(a.slug);const p=c.get(a.slug);c.set(a.slug,{can_synchronize:p.can_synchronize,lang:p.lang,links:{add_link:p.links.add_link}});const u=c.get(l.slug);c.set(l.slug,{can_synchronize:u.can_synchronize,lang:u.lang,links:p.links,translated_post:p.translated_post}),pll_block_editor_plugin_settings=l,(0,s.dispatch)(_).editPost({lang:l.slug}),(0,s.dispatch)(_).editPost({pll_sync_post:b(o)}),(0,s.dispatch)(_).editPost({translations:b(i)}),(0,s.dispatch)(_).editPost({translations_table:b(c)}),(0,s.dispatch)(_).savePost(),B.forceLanguageSave(a.slug),B.invalidateParentPagesStoredInCore()}static forceLanguageSave(e){const t=(0,s.select)(_);t.getEditedPostAttribute("title")||t.getEditedPostContent()||t.getEditedPostAttribute("excerpt")||p()({path:(0,u.addQueryArgs)(`wp/v2/posts/${t.getCurrentPostId()}`,{lang:e}),method:"POST"})}static invalidateParentPagesStoredInCore(){const e=(0,s.select)(_).getCurrentPostId(),t=(0,s.select)(_).getEditedPostAttribute("type"),n={per_page:-1,exclude:e,parent_exclude:e,orderby:"menu_order",order:"asc"};(0,s.dispatch)("core/data").invalidateResolution("core","getEntityRecords",["postType",t,n])}render(){const t=(0,s.select)(f).getLanguages(),n=S((0,s.select)(_).getEditedPostAttribute("lang"));return(0,e.createElement)(e.Fragment,null,(0,e.createElement)("p",null,(0,e.createElement)("strong",null,(0,i.__)("Language","polylang-pro"))),(0,e.createElement)("label",{className:"screen-reader-text",htmlFor:"pll_post_lang_choice"},(0,i.__)("Language","polylang-pro")),(0,e.createElement)(I,{selectedLanguage:n,handleChange:this.props.handleChange},(0,e.createElement)(j,{languages:t})))}}B.labelConfirmationModal=(0,i.__)("Change language","polylang-pro");const V=m("pll_change_lang",(function(){return(0,e.createElement)("p",null,(0,i.__)("Are you sure you want to change the language of the current content?","polylang-pro"))}),B.handleLanguageChange)(B),W=()=>(0,e.createElement)(e.Fragment,null,(0,e.createElement)(d.Icon,{icon:z,className:"pll-defaut-lang-icon"}),(0,e.createElement)("span",{className:"screen-reader-text"},(0,i.__)("Default language.","polylang-pro")));class $ extends e.Component{constructor(){super(...arguments),this.state={isDefaultLanguage:this.props.language.slug===L(this.props.translationsTable).slug}}render(){return(0,e.createElement)(e.Fragment,null,(0,e.createElement)("p",null,(0,e.createElement)("strong",null,(0,i.__)("Language","polylang-pro"))),(0,e.createElement)("div",{className:"pll-language-item"},(0,e.createElement)(F,{language:this.props.language}),(0,e.createElement)("span",{className:"pll-language-name"},(0,i.__)(this.props.language.name,"polylang-pro")),this.state.isDefaultLanguage&&(0,e.createElement)(W,null)),this.state.isDefaultLanguage&&(0,e.createElement)("div",null,(0,e.createElement)("span",{className:"pll-metabox-info"},(0,i.__)("This template part is used for languages that have not yet been translated.","polylang-pro"))))}}const H=$;class G extends e.Component{constructor(){super(...arguments);const e=(0,s.select)(f).getCurrentUser();this.postType=P()?(0,s.select)(y).getEditedPostType():(0,s.select)(_).getCurrentPostType(),this.state={isDuplicateActive:this.isDuplicateActive(e),currentUser:e},this.handleDuplicateContentChange=this.handleDuplicateContentChange.bind(this),this.setState=this.setState.bind(this)}isDuplicateActive(e){return!(0,a.isUndefined)(e.pll_duplicate_content)&&!(0,a.isUndefined)(e.pll_duplicate_content[this.postType])&&e.pll_duplicate_content[this.postType]}handleDuplicateContentChange(e){const t=this.state.currentUser;((0,a.isUndefined)(t.pll_duplicate_content)||(0,a.isString)(t.pll_duplicate_content))&&(t.pll_duplicate_content={}),t.pll_duplicate_content[this.postType]=!this.state.isDuplicateActive,this.setState({currentUser:t,isDuplicateActive:!this.state.isDuplicateActive}),(0,s.dispatch)(f).setCurrentUser({pll_duplicate_content:t.pll_duplicate_content},!0)}render(){const t=this.state.isDuplicateActive,n=this.state.isDuplicateActive?(0,i.__)("Deactivate the content duplication","polylang-pro"):(0,i.__)("Activate the content duplication","polylang-pro");return(0,e.createElement)(d.IconButton,{id:"pll-duplicate",className:`pll-button ${t&&"wp-ui-text-highlight"}`,onClick:this.handleDuplicateContentChange,icon:A,label:n},(0,e.createElement)("span",{className:"screen-reader-text"},n))}}const K=G;class q extends e.Component{constructor(){super(...arguments)}static handleSynchronizationChange(e){const t=N((0,s.select)(_).getEditedPostAttribute("pll_sync_post"));t.has(e)?t.delete(e):t.set(e,!0),(0,s.dispatch)(_).editPost({pll_sync_post:b(t)}),(0,s.dispatch)(_).editPost({title:(0,s.select)(_).getEditedPostAttribute("title")})}static bypassConfirmation(e){const t=N((0,s.select)(_).getEditedPostAttribute("pll_sync_post")),n=!(0,a.isEmpty)(t)&&t.has(e.lang.slug),l=!(0,a.isUndefined)(e.translated_post)&&!(0,a.isNil)(e.translated_post.id);return n||!l}static getChangeValue(e){return e.currentTarget.id.match(/\[(.[^[]+)\]/i)[1]}render(){const t=N((0,s.select)(_).getEditedPostAttribute("pll_sync_post")),n=this.props.translationData,l=!(0,a.isEmpty)(t)&&t.has(n.lang.slug),o=l&&"wp-ui-text-highlight",r=l?(0,i.__)("Don't synchronize this post","polylang-pro"):(0,i.__)("Synchronize this post","polylang-pro");return(0,e.createElement)(d.IconButton,{icon:D,label:r,id:`pll_sync_post[${n.lang.slug}]`,className:`pll-button ${o}`,onClick:e=>{this.props.handleChange(e)}},(0,e.createElement)("span",{className:"screen-reader-text"},r))}}q.labelConfirmationModal=(0,i.__)("Synchronize this post","polylang-pro");const Q=m("pll_sync_post",(function(){return(0,e.createElement)("p",null,(0,i.__)("You are about to overwrite an existing translation. Are you sure you want to proceed?","polylang-pro"))}),q.handleSynchronizationChange)(q),Y={setLanguages:e=>({type:"SET_LANGUAGES",languages:e}),setCurrentUser(e){return{type:"SET_CURRENT_USER",currentUser:e,save:arguments.length>1&&void 0!==arguments[1]&&arguments[1]}},setFromPost:e=>({type:"SET_FROM_POST",fromPost:e}),fetchFromAPI:e=>({type:"FETCH_FROM_API",options:e}),setCurrentTemplatePart:e=>({type:"SET_CURRENT_TEMPLATE_PART",currentTemplatePart:e})},X=((0,s.registerStore)(f,{reducer(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_LANGUAGES":return{...e,languages:t.languages};case"SET_CURRENT_USER":return t.save&&(n=t.currentUser,p()({path:"/wp/v2/users/me",data:n,method:"POST"})),{...e,currentUser:t.currentUser};case"SET_FROM_POST":return{...e,fromPost:t.fromPost};case"SET_CURRENT_TEMPLATE_PART":return{...e,currentTemplatePart:t.currentTemplatePart};default:return e}var n},selectors:{getLanguages:e=>e.languages,getCurrentUser:e=>e.currentUser,getFromPost:e=>e.fromPost,getCurrentTemplatePart:e=>e.currentTemplatePart},actions:Y,controls:{FETCH_FROM_API:e=>p()({...e.options})},resolvers:{*getLanguages(){const e=yield Y.fetchFromAPI({path:"/pll/v1/languages",filterLang:!1});return Y.setLanguages(function(e,t){const n=new Map;return e.reduce((function(e,n){return e.set(n[t],n),e}),n),n}(e,"slug"))},*getCurrentUser(){const e=yield Y.fetchFromAPI({path:"/wp/v2/users/me",filterLang:!0});return Y.setCurrentUser(e)},*getCurrentTemplatePart(){const e=Z();return Y.setCurrentTemplatePart(e)}}}),new Promise((function(e){let t=(0,s.subscribe)((function(){(0,s.select)(f).getLanguages().size>0&&(t(),e())}))})));function J(){const e=(window.location.search,(0,a.isEmpty)(window.location.search)?null:new URLSearchParams(window.location.search));null!==e&&(0,s.dispatch)(f).setFromPost({id:wp.sanitize.stripTagsAndEncodeText(e.get("from_post")),postType:wp.sanitize.stripTagsAndEncodeText(e.get("post_type")),newLanguage:wp.sanitize.stripTagsAndEncodeText(e.get("new_lang"))})}function Z(){var e,t;const n=null===(e=(0,s.select)(y))||void 0===e?void 0:e.getEditedPostId(),l=null===(t=(0,s.select)(y))||void 0===t?void 0:t.getEditedPostType();return(0,s.select)(v).getEntityRecord("postType",l,n)}const ee=e=>{const t=e.target.closest("a.pll-button").getAttribute("data-target-language"),n=Z(),l={[n.lang]:n.wp_id},o=(0,s.select)(f).getCurrentUser().pll_duplicate_content.wp_template_part?n.content.raw:"",r=function(){let e="[a-z_-]+";const t=(0,s.select)(f).getLanguages(),n=Array.from(t.keys());return(0,a.isEmpty)(n)||(e=n.join("|")),new RegExp(`___(?:${e})$`)}(),i=n.slug.replace(r,"");p()({path:"/wp/v2/template-parts",method:"POST",data:{slug:i,title:n.title.raw,content:o,area:n.area,lang:t,from_post:n.wp_id,translations:l}}).then((e=>{var n;const l=null===(n=(0,a.get)(e.translations_table,t))||void 0===n?void 0:n.links.edit_link;(0,a.isNil)(l)||(location.href=l)}))},te=t=>{let{translationData:n}=t;const l=!(0,a.isUndefined)(n.translated_post)&&!(0,a.isNil)(n.translated_post.id),s=!(0,a.isUndefined)(n.links)&&!(0,a.isNil)(n.links.edit_link),o=!(0,a.isUndefined)(n.links)&&!(0,a.isEmpty)(n.links.add_link);let r=O,c=(0,i.sprintf)((0,i.__)("Add a translation in %s","polylang-pro"),n.lang.name),p=decodeURI(n.links.add_link);return l&&(r=U,c=(0,i.sprintf)((0,i.__)("Edit the translation in %s","polylang-pro"),n.lang.name),p=decodeURI(n.links.edit_link)),!o&&!l||!s&&l?null:P()&&!l?(0,e.createElement)(d.Button,{href:"#",icon:r,label:c,className:"pll-button",onClick:ee,"data-target-language":n.lang.slug},(0,e.createElement)("span",{className:"screen-reader-text"},c)):(0,e.createElement)(d.Button,{href:p,icon:r,label:c,className:"pll-button"},(0,e.createElement)("span",{className:"screen-reader-text"},c))};var ne=n(184),le=n.n(ne);function se(e){return se="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},se(e)}function ae(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function oe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,l)}return n}function re(e,t){var n=e["page".concat(t?"Y":"X","Offset")],l="scroll".concat(t?"Top":"Left");if("number"!=typeof n){var s=e.document;"number"!=typeof(n=s.documentElement[l])&&(n=s.body[l])}return n}function ie(e){return re(e)}function ce(e){return re(e,!0)}function pe(e){var t=function(e){var t,n,l,s=e.ownerDocument,a=s.body,o=s&&s.documentElement;return n=(t=e.getBoundingClientRect()).left,l=t.top,{left:n-=o.clientLeft||a.clientLeft||0,top:l-=o.clientTop||a.clientTop||0}}(e),n=e.ownerDocument,l=n.defaultView||n.parentWindow;return t.left+=ie(l),t.top+=ce(l),t}var ue,de=new RegExp("^(".concat(/[\-+]?(?:\d*\.|)\d+(?:[eE][\-+]?\d+|)/.source,")(?!px)[a-z%]+$"),"i"),ge=/^(top|right|bottom|left)$/;function he(e,t){for(var n=0;n<e.length;n++)t(e[n])}function me(e){return"border-box"===ue(e,"boxSizing")}"undefined"!=typeof window&&(ue=window.getComputedStyle?function(e,t,n){var l="",s=e.ownerDocument,a=n||s.defaultView.getComputedStyle(e,null);return a&&(l=a.getPropertyValue(t)||a[t]),l}:function(e,t){var n=e.currentStyle&&e.currentStyle[t];if(de.test(n)&&!ge.test(t)){var l=e.style,s=l.left,a=e.runtimeStyle.left;e.runtimeStyle.left=e.currentStyle.left,l.left="fontSize"===t?"1em":n||0,n=l.pixelLeft+"px",l.left=s,e.runtimeStyle.left=a}return""===n?"auto":n});var fe=["margin","border","padding"];function _e(e,t,n){var l,s={},a=e.style;for(l in t)t.hasOwnProperty(l)&&(s[l]=a[l],a[l]=t[l]);for(l in n.call(e),t)t.hasOwnProperty(l)&&(a[l]=s[l])}function ye(e,t,n){var l,s,a,o=0;for(s=0;s<t.length;s++)if(l=t[s])for(a=0;a<n.length;a++){var r=void 0;r="border"===l?"".concat(l+n[a],"Width"):l+n[a],o+=parseFloat(ue(e,r))||0}return o}function ve(e){return null!=e&&e==e.window}var Ee={};function we(e,t,n){if(ve(e))return"width"===t?Ee.viewportWidth(e):Ee.viewportHeight(e);if(9===e.nodeType)return"width"===t?Ee.docWidth(e):Ee.docHeight(e);var l="width"===t?["Left","Right"]:["Top","Bottom"],s="width"===t?e.offsetWidth:e.offsetHeight,a=(ue(e),me(e)),o=0;(null==s||s<=0)&&(s=void 0,(null==(o=ue(e,t))||Number(o)<0)&&(o=e.style[t]||0),o=parseFloat(o)||0),void 0===n&&(n=a?1:-1);var r=void 0!==s||a,i=s||o;if(-1===n)return r?i-ye(e,["border","padding"],l):o;if(r){var c=2===n?-ye(e,["border"],l):ye(e,["margin"],l);return i+(1===n?0:c)}return o+ye(e,fe.slice(n),l)}he(["Width","Height"],(function(e){Ee["doc".concat(e)]=function(t){var n=t.document;return Math.max(n.documentElement["scroll".concat(e)],n.body["scroll".concat(e)],Ee["viewport".concat(e)](n))},Ee["viewport".concat(e)]=function(t){var n="client".concat(e),l=t.document,s=l.body,a=l.documentElement[n];return"CSS1Compat"===l.compatMode&&a||s&&s[n]||a}}));var be={position:"absolute",visibility:"hidden",display:"block"};function Pe(e){var t,n=arguments;return 0!==e.offsetWidth?t=we.apply(void 0,n):_e(e,be,(function(){t=we.apply(void 0,n)})),t}function Se(e,t,n){var l=n;if("object"!==se(t))return void 0!==l?("number"==typeof l&&(l+="px"),void(e.style[t]=l)):ue(e,t);for(var s in t)t.hasOwnProperty(s)&&Se(e,s,t[s])}he(["width","height"],(function(e){var t=e.charAt(0).toUpperCase()+e.slice(1);Ee["outer".concat(t)]=function(t,n){return t&&Pe(t,e,n?0:1)};var n="width"===e?["Left","Right"]:["Top","Bottom"];Ee[e]=function(t,l){if(void 0===l)return t&&Pe(t,e,-1);if(t){ue(t);return me(t)&&(l+=ye(t,["padding","border"],n)),Se(t,e,l)}}}));var Ce=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?oe(n,!0).forEach((function(t){ae(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):oe(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({getWindow:function(e){var t=e.ownerDocument||e;return t.defaultView||t.parentWindow},offset:function(e,t){if(void 0===t)return pe(e);!function(e,t){"static"===Se(e,"position")&&(e.style.position="relative");var n,l,s=pe(e),a={};for(l in t)t.hasOwnProperty(l)&&(n=parseFloat(Se(e,l))||0,a[l]=n+t[l]-s[l]);Se(e,a)}(e,t)},isWindow:ve,each:he,css:Se,clone:function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);if(e.overflow)for(var l in e)e.hasOwnProperty(l)&&(t.overflow[l]=e.overflow[l]);return t},scrollLeft:function(e,t){if(ve(e)){if(void 0===t)return ie(e);window.scrollTo(t,ce(e))}else{if(void 0===t)return e.scrollLeft;e.scrollLeft=t}},scrollTop:function(e,t){if(ve(e)){if(void 0===t)return ce(e);window.scrollTo(ie(e),t)}else{if(void 0===t)return e.scrollTop;e.scrollTop=t}},viewportWidth:0,viewportHeight:0},Ee);const Te=function(e,t,n){n=n||{},9===t.nodeType&&(t=Ce.getWindow(t));var l=n.allowHorizontalScroll,s=n.onlyScrollIfNeeded,a=n.alignWithTop,o=n.alignWithLeft,r=n.offsetTop||0,i=n.offsetLeft||0,c=n.offsetBottom||0,p=n.offsetRight||0;l=void 0===l||l;var u,d,g,h,m,f,_,y,v,E,w=Ce.isWindow(t),b=Ce.offset(e),P=Ce.outerHeight(e),S=Ce.outerWidth(e);w?(_=t,E=Ce.height(_),v=Ce.width(_),y={left:Ce.scrollLeft(_),top:Ce.scrollTop(_)},m={left:b.left-y.left-i,top:b.top-y.top-r},f={left:b.left+S-(y.left+v)+p,top:b.top+P-(y.top+E)+c},h=y):(u=Ce.offset(t),d=t.clientHeight,g=t.clientWidth,h={left:t.scrollLeft,top:t.scrollTop},m={left:b.left-(u.left+(parseFloat(Ce.css(t,"borderLeftWidth"))||0))-i,top:b.top-(u.top+(parseFloat(Ce.css(t,"borderTopWidth"))||0))-r},f={left:b.left+S-(u.left+g+(parseFloat(Ce.css(t,"borderRightWidth"))||0))+p,top:b.top+P-(u.top+d+(parseFloat(Ce.css(t,"borderBottomWidth"))||0))+c}),m.top<0||f.top>0?!0===a?Ce.scrollTop(t,h.top+m.top):!1===a?Ce.scrollTop(t,h.top+f.top):m.top<0?Ce.scrollTop(t,h.top+m.top):Ce.scrollTop(t,h.top+f.top):s||((a=void 0===a||!!a)?Ce.scrollTop(t,h.top+m.top):Ce.scrollTop(t,h.top+f.top)),l&&(m.left<0||f.left>0?!0===o?Ce.scrollLeft(t,h.left+m.left):!1===o?Ce.scrollLeft(t,h.left+f.left):m.left<0?Ce.scrollLeft(t,h.left+m.left):Ce.scrollLeft(t,h.left+f.left):s||((o=void 0===o||!!o)?Ce.scrollLeft(t,h.left+m.left):Ce.scrollLeft(t,h.left+f.left)))};var Ne=n(638),xe=n(19);const Le=e=>e.stopPropagation();class ke extends e.Component{constructor(){super(...arguments),this.onChange=this.onChange.bind(this),this.onKeyDown=this.onKeyDown.bind(this),this.bindListNode=this.bindListNode.bind(this),this.updateSuggestions=(0,a.throttle)(this.updateSuggestions.bind(this),200),this.suggestionNodes=[],this.state={posts:[],showSuggestions:!1,selectedSuggestion:null}}componentDidUpdate(){const{showSuggestions:e,selectedSuggestion:t}=this.state;e&&null!==t&&!this.scrollingIntoView&&(this.scrollingIntoView=!0,Te(this.suggestionNodes[t],this.listNode,{onlyScrollIfNeeded:!0}),setTimeout((()=>{this.scrollingIntoView=!1}),100))}componentWillUnmount(){delete this.suggestionsRequest}bindListNode(e){this.listNode=e}bindSuggestionNode(e){return t=>{this.suggestionNodes[e]=t}}updateSuggestions(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e.length<2&&!t)return void this.setState({showSuggestions:!1,selectedSuggestion:null,loading:!1});this.setState({selectedSuggestion:null,loading:!0});const n=(0,s.select)(_).getCurrentPostId(),l=(0,s.select)(_).getCurrentPostType(),a=(0,s.select)(_).getEditedPostAttribute("lang"),o=this.props.translationData.lang.slug,r=p()({path:(0,u.addQueryArgs)("/pll/v1/untranslated-posts",{search:e,include:n,untranslated_in:a,lang:o,type:l,is_block_editor:!0})});r.then((e=>{this.suggestionsRequest===r&&(this.setState({posts:e,showSuggestions:!0,loading:!1}),e.length?this.props.debouncedSpeak((0,i.sprintf)((0,i._n)("%d result found, use up and down arrow keys to navigate.","%d results found, use up and down arrow keys to navigate.",e.length,"polylang-pro"),e.length),"assertive"):this.props.debouncedSpeak((0,i.__)("No results.","polylang-pro"),"assertive"))})).catch((()=>{this.suggestionsRequest===r&&this.setState({loading:!1})})),this.suggestionsRequest=r}onChange(e){const t=e.target.value,n=this.props.translatedPosts,l=this.props.translationsTable,s=this.props.translationData.lang;this.props.onChange({value:t,translatedPosts:n,translationsTable:l,language:s}),this.updateSuggestions(t)}onKeyDown(e){const{showSuggestions:t,selectedSuggestion:n,posts:l,loading:s}=this.state;let o=e.target.value,r=!1;if(t&&l.length&&!s)switch(e.keyCode){case xe.UP:{e.stopPropagation(),e.preventDefault();const t=n?n-1:l.length-1;this.setState({selectedSuggestion:t});break}case xe.DOWN:{e.stopPropagation(),e.preventDefault();const t=null===n||n===l.length-1?0:n+1;this.setState({selectedSuggestion:t});break}case xe.ENTER:if(null!==this.state.selectedSuggestion){e.stopPropagation();const t=this.state.posts[this.state.selectedSuggestion];this.selectLink(t)}break;case xe.ESCAPE:e.stopPropagation(),this.setState({selectedSuggestion:null,showSuggestions:!1})}else{switch(e.keyCode){case xe.SPACE:const{ctrlKey:t,shiftKey:n,altKey:l,metaKey:s}=e;t&&!(n||l||s)&&(o="",r=!0);break;case xe.BACKSPACE:(0,a.isEmpty)(o)&&(r=!0)}r&&this.updateSuggestions(o,!0)}}selectLink(e){const t=this.props.translationsTable,n=this.props.translatedPosts,l=this.props.translationData.lang;this.props.onChange({value:e.title.rendered,post:e,translatedPosts:n,translationsTable:t,language:l}),this.setState({selectedSuggestion:null,showSuggestions:!1})}render(){const{value:t="",autoFocus:n=!0,instanceId:l,translationData:s}=this.props,o=s.lang,{showSuggestions:r,posts:c,selectedSuggestion:p,loading:u}=this.state,g=!(0,a.isUndefined)(s.links)&&((0,a.isUndefined)(s.links.edit_link)||!(0,a.isUndefined)(s.links.edit_link)&&!(0,a.isNull)(s.links.edit_link));return(0,e.createElement)(e.Fragment,null,(0,e.createElement)("div",{className:"translation-input"},(0,e.createElement)("input",{lang:o.w3c,dir:o.is_rtl?"rtl":"ltr",style:{direction:o.is_rtl?"rtl":"ltr"},autoFocus:n,disabled:!g,type:"text","aria-label":(0,i.__)("URL","polylang-pro"),required:!0,value:t,onChange:this.onChange,onInput:Le,placeholder:(0,i.__)("Start typing the post title","polylang-pro"),onKeyDown:this.onKeyDown,role:"combobox","aria-expanded":r,"aria-autocomplete":"list","aria-owns":`translation-input-suggestions-${l}`,"aria-activedescendant":null!==p?`translation-input-suggestion-${l}-${p}`:void 0}),u&&(0,e.createElement)(d.Spinner,null)),r&&!!c.length&&(0,e.createElement)(d.Popover,{position:"bottom",noArrow:!0,focusOnMount:!1},(0,e.createElement)("div",{className:"translation-input__suggestions",id:`translation-input-suggestions-${l}`,ref:this.bindListNode,role:"listbox"},c.map(((t,n)=>(0,e.createElement)("button",{key:t.id,role:"option",tabIndex:"-1",id:`translation-input-suggestion-${l}-${n}`,ref:this.bindSuggestionNode(n),className:le()("translation-input__suggestion",{"is-selected":n===p}),onClick:()=>this.selectLink(t),"aria-selected":n===p},(0,Ne.decodeEntities)(t.title.rendered)||(0,i.__)("(no title)","polylang-pro")))))))}}const Ae=(0,d.withSpokenMessages)((0,g.withInstanceId)(ke));function Ue(){return Ue=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(e[l]=n[l])}return e},Ue.apply(this,arguments)}class Oe extends e.Component{static handleDelete(e){let{templateId:t,currentPost:n}=e;if(!(0,a.isEmpty)(t)){const e=function(e){const t=(0,s.select)("core").getEntitiesByKind("postType"),n=(0,a.find)(t,{name:e});return null==n?void 0:n.baseURL}(n.type);p()({path:`${e}/${t}`,method:"GET"}).then((e=>{if(!(0,a.isEmpty)(e)){const{translations_table:t,translations:l}=n,a=x(t).get(e.lang);e.title.rendered=e.title.rendered+" in "+a.lang.name,(0,s.dispatch)(y).removeTemplate(e),delete a.translated_post;const o=T(l);o.delete(e.lang),n.translations=b(o),(0,s.dispatch)(y).setTemplatePart(n.id),C(a.lang.slug)&&(location.href=(0,u.removeQueryArgs)(location.href,"postId"))}}))}}static getChangeValue(e){const t=e.currentTarget.id;return(0,a.isEmpty)(t)?"":t.match(/\[(.[^[]+)\]/i)[1]}render(){const{lang:t,translated_post:n,links:l,template:s}=this.props.translationData,o=(0,i.sprintf)((0,i.__)("Delete the translation in %s","polylang-pro"),t.name),r=!(0,a.isUndefined)(l.delete_link),c=!(0,a.isUndefined)(n)&&!(0,a.isNil)(n.id);return r?(0,e.createElement)(d.Button,Ue({icon:R,label:o,disabled:!c},s?{id:`templateId[${s.id}]`}:{},{className:"pll-button",onClick:this.props.handleChange}),(0,e.createElement)("span",{className:"screen-reader-text"},o)):null}}Oe.labelConfirmationModal=(0,i.__)("Delete template part confirmation","polylang-pro");const De=m("pll_delete_translation",(t=>{let{isDefaultLang:n}=t;return(0,e.createElement)(e.Fragment,null,n&&(0,e.createElement)("p",null,(0,i.__)("You are about to delete the template part in the default language.","polylang-pro"),(0,e.createElement)("br",null),(0,i.__)("This will delete its customization and all its corresponding translations.","polylang-pro")),(0,e.createElement)("p",null,(0,i.__)("Are you sure you want to delete this template part?","polylang-pro")))}),Oe.handleDelete)(Oe),Me=e=>{let{value:t,post:n=null,translatedPosts:l,translationsTable:o,language:r}=e;const i=o.get(r.slug);(0,a.isEmpty)(n)?(i.translated_post={id:null,title:t},i.links={add_link:i.links.add_link},l.delete(r.slug)):(l.set(r.slug,n.id),i.translated_post={id:n.id,title:n.title.rendered},i.links.edit_link=n.edit_link),o.set(r.slug,i),(0,s.dispatch)(_).editPost({translations:b(l)}),(0,s.dispatch)(_).editPost({title:(0,s.select)(_).getEditedPostAttribute("title")})},Re=t=>{let{selectedLanguage:n,translationsTable:l,translatedPosts:s,currentPost:o}=t;return(0,e.createElement)("div",{id:"post-translations",className:"translations"},(0,e.createElement)("p",null,(0,e.createElement)("strong",null,(0,i.__)("Translations","polylang-pro"))),(0,e.createElement)("table",null,(0,e.createElement)("tbody",null,Array.from(l.values()).map((t=>n.slug!==t.lang.slug&&(0,e.createElement)("tr",{key:t.lang.slug},(0,e.createElement)("th",{className:"pll-language-column"},(0,a.isEmpty)(t.lang.flag)?(0,e.createElement)("abbr",null,t.lang.slug,(0,e.createElement)("span",{className:"screen-reader-text"},t.lang.name)):(0,e.createElement)("span",{className:"pll-select-flag flag"},(0,e.createElement)("img",{src:t.lang.flag_url,alt:t.lang.name,title:t.lang.name}))),P()&&(0,e.createElement)(e.Fragment,null,(0,e.createElement)("td",{className:"pll-translation-column"},(0,e.createElement)("span",{className:"pll-translation-language"},t.lang.name)),(0,e.createElement)("td",{className:"pll-edit-column pll-column-icon"},(0,e.createElement)(te,{translationData:t})),(0,e.createElement)("td",{className:"pll-delete-column pll-column-icon"},(0,e.createElement)(De,{translationData:t,currentPost:o})),(0,e.createElement)("td",{className:"pll-default-lang-column pll-column-icon"},t.is_default_lang&&(0,e.createElement)(W,null))),!P()&&(0,e.createElement)(e.Fragment,null,(0,e.createElement)("td",{className:"pll-edit-column pll-column-icon"},(0,e.createElement)(te,{translationData:t})),(0,e.createElement)("td",{className:"pll-sync-column pll-column-icon"},t.can_synchronize&&(0,e.createElement)(Q,{translationData:t})),(0,e.createElement)("td",{className:"pll-translation-column"},(0,e.createElement)("label",{className:"screen-reader-text",htmlFor:`tr_lang_${t.lang.slug}`},(0,i.__)("Translation","polylang-pro")),(0,e.createElement)(Ae,{id:`htr_lang_${t.lang.slug}`,autoFocus:!1,translationsTable:l,translatedPosts:s,translationData:t,value:(0,a.isUndefined)(t.translated_post)?"":t.translated_post.title,onChange:Me})))))))))};class ze extends e.Component{render(){return this.props.isAllowedPostType?(0,e.createElement)("div",{className:"components-panel__body is-opened"},(0,a.isNil)(this.props.selectedLanguage)?(0,e.createElement)("div",{className:"pll-metabox-error components-notice is-error"},(0,i.__)("Unable to retrieve the content language","polylang-pro")):(0,e.createElement)("form",{className:"pll-metabox-location"},"wp_template_part"===this.props.currentPost.type?(0,e.createElement)(e.Fragment,null,(0,e.createElement)(H,{language:this.props.selectedLanguage,translationsTable:this.props.translationsTable})):(0,e.createElement)(e.Fragment,null,(0,e.createElement)(V,{selectedLanguage:this.props.selectedLanguage}),(0,e.createElement)(K,null)),(0,e.createElement)(Re,{selectedLanguage:this.props.selectedLanguage,translationsTable:this.props.translationsTable,translatedPosts:this.props.translatedPosts,currentPost:this.props.currentPost}))):(0,e.createElement)("div",{className:"components-panel__body is-opened"},(0,e.createElement)("div",{className:"pll-metabox-error components-notice is-warning"},(0,i.__)("Templates are not translatable, only template parts are.","polylang-pro")))}}const Fe=(0,s.withSelect)((e=>{let t="",n=[],l=[],s={},o=!1;s=P()?Z():e(_).getCurrentPost(),o=!(0,a.isNil)(s)&&!w.includes(s.type),(0,a.isNil)(s)||(t=s.lang,n=s.translations_table,l=s.translations);return{currentPost:s,selectedLanguage:S(t),translationsTable:x(n),translatedPosts:T(l,n,t),isAllowedPostType:o}}))(ze),Ie=Fe,je=()=>P()?(0,e.createElement)(r.PluginSidebar,{name:"polylang-sidebar",title:(0,i.__)("Languages","polylang-pro")},(0,e.createElement)(Ie,null)):(0,e.createElement)(o.PluginSidebar,{name:"polylang-sidebar",title:(0,i.__)("Languages","polylang-pro")},(0,e.createElement)(Ie,null)),Be=()=>(0,e.createElement)(o.PluginSidebarMoreMenuItem,{target:"polylang-sidebar"},(0,i.__)("Languages","polylang-pro")),Ve=()=>(0,e.createElement)(e.Fragment,null,(0,e.createElement)(je,null),(0,e.createElement)(Be,null));if(P()){const e=e=>{const t=new URL(e).searchParams,n=t.get("postType"),l=t.get("postId");pll_block_editor_plugin_settings.lang.is_default_lang||!(0,a.isNil)(l)||(0,a.isNil)(n)||(0,a.isEmpty)((0,a.intersection)([n],["wp_template","wp_template_part"]))||(0,s.dispatch)(v).invalidateResolutionForStore()};window.onpopstate=t=>{e(document.location.href)},(t=>{const n=t.pushState,l=t.replaceState;t.pushState=(l,s,a)=>(e(a),n.apply(t,[l,s,a])),t.replaceState=(n,s,a)=>(e(a),l.apply(t,[n,s,a]))})(window.history),(()=>{J();const e=new Promise((function(e){let t=(0,s.subscribe)((function(){const n=(0,s.select)(f).getCurrentUser();(0,a.isNil)(n)||(0,a.isEmpty)(n)||(t(),e())}))})),t=new Promise((function(e){let t=(0,s.subscribe)((function(){const n=Z();(0,a.isNil)(n)||(0,a.isEmpty)(n)||(t(),e())}))}));return Promise.all([e,t,X]).then((()=>{const e=(0,s.select)(f).getCurrentUser();(0,a.isString)(e.pll_duplicate_content)&&(e.pll_duplicate_content={}),e.pll_duplicate_content.wp_template_part=!0,(0,s.dispatch)(f).setCurrentUser({pll_duplicate_content:e.pll_duplicate_content},!0)}))})().then((function(e){(0,t.registerPlugin)("polylang-sidebar",{icon:M,render:Ve})}))}else(()=>{if((0,a.isNil)((0,s.select)(_)))return Promise.reject("Polylang languages panel can't be initialized because block editor isn't fully initialized.");J(),(0,s.select)(f).getCurrentUser();const e=new Promise((function(e){let t=(0,s.subscribe)((function(){const n=(0,s.select)(_).getCurrentPost();(0,a.isEmpty)(n)||(t(),e())}))}));return Promise.all([e,X]).then((function(){const e=(0,s.select)(f).getFromPost();if(!(0,a.isNil)(e)&&!(0,a.isNil)(e.id)){const e=(0,s.select)(_).getEditedPostAttribute("lang"),t=T((0,s.select)(_).getEditedPostAttribute("translations"),(0,s.select)(_).getEditedPostAttribute("translations_table"),e);(0,s.dispatch)(_).editPost({translations:b(t)})}}))})().then((function(e){(0,t.registerPlugin)("polylang-sidebar",{icon:M,render:Ve})}),(function(e){console.info(e)}))})(),this["polylang-pro"]=l})();